# 13.The Abstraction: Address Spaces

![image-20211208190559376](<../../.gitbook/assets/image 20211208190559376>)

在内存中，每个进程都有自己独立的内存空间，OS给每个进程都分配了物理内存空间，以实现multiprogramming和time-sharing的要求。

但OS只提供给进程虚拟的**地址空间**。如下图所示，**代码段**（指令段）起始值放在0地址；接下来是**堆**，用于动态分配内存（如C中的malloc，C++、Java中的new），新的地址从低向高增长；最高地址是**栈**底，用于保存函数调用信息、局部变量、返回值等，它从高向低增长。

![image-20211208190953708](<../../.gitbook/assets/image 20211208190953708>)

要注意这里的‘0KB’地址并不是真正内存中的0地址，而是虚拟地址。事实上，用户所见的所有地址都是虚拟地址，只有OS知道真实的物理地址位置。

这些**虚拟内存**（**V**irtual **M**emory）的目标是：

* 对于程序**透明**，以给程序一种“拥有私有物理内存”的假象（illusion）。
* **高效**。OS依靠硬件支持，来实现虚拟化在时间和空间上的高效。
* **保护**。各个进程相互**隔离（isolation）**，防止一些进程对其他进程的破坏。
